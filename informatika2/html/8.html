<html>
<head>
</head>
<body>
<h1>Функции-процедуры VBA</h1>
<p>Функция-процедура - это особый вид процедуры VBA, возвращающей результат. Пользовательские функции-процедуры, как и встроенные функции VBA, могут иметь необязательные и именованные аргументы. Для записи функции-процедуры нельзя использовать макрорекордер, хотя можно редактировать записанный рекордером макрос и превращать его в функцию-процедуру.</p>

<p>Основное различие между функцией-процедурой и другими процедурами, помимо того, что функции возвращают значение, а процедуры - нет, состоит в том, что в функции-процедуре используются ключевые слова Function и End Function.</p>

<p>Синтаксис:</p>


<pre>Function Name([Arglist]) [As Type]
'VBA Statements
[Name = expression]
End Function
</pre>
<p>Function - ключевое слово, объявляющее начало функции.</p>

<p>Name - имя функции. Имена функций следуют тем же правилам, что и имена других идентификаторов VBA.</p>

<p>Arglist - список аргументов данной функции, необязательный элемент.</p>

<p>Type - любой тип возвращаемого значения функции. Если тип не определен, результат, который возвращает функция-процедура, имеет тип Variant.</p>

<p>Name = expression - присваивание функции, которое указывает VBA, какое значение должна возвращать функция, необязательный элемент. Тем не менее, всегда следует включать оператор присваивания в функции-процедуры.</p>

<p>End Function - ключевые слова, заканчивающие функцию.</p>


<p>Даже если функция не имеет аргументов (например, Now, Date) в объявлении функции необходимо использовать круглые скобки.</p>

<p>Обычно функция предназначается для выполнения вычисления и для возвращения результата. При объявлении функции-процедуры указывается имя каждого аргумента, передаваемого функции. Имена аргументов в списке отделяются друг от друга запятой и должны следовать правилам, применяемым к любому идентификатору VBA.</p>


<p>Ниже представлен листинг использования простейшей функции-процедуры, которая убирает начальные и конечные пробелы и подсчитывает количество символов в выражении.</p>
</body>
</html>