<html>
<head>
</head>
<body>
<h1>Работа с объектами</h1>
<p>При создании приложения в VBA в основном происходит работа с объектами. Можно использовать объекты, предоставляемые VBA: элементы управления, формы и объекты доступа к данным. Можно также управлять объектами других приложений из приложения VBA. Можно даже создавать свои собственные объекты и определять для них дополнительные свойства и методы.</p>
<h2>Что такое объект?</h2>
<p>Объект - это комбинация кода и данных, которую можно рассматривать как одно целое. Объект может быть частью приложения, как элемент управления или форма. Целое приложение также может быть объектом. В таблице приведены примеры типов объектов, которые можно использовать в VBA:</p>
<h2>Объект	Описание</h2>
<p>Кнопка управления	Элементы управления на форме, например кнопки управления и рамки, являются объектами</p>
<p>Форма	Каждая форма в проекте VBA является отдельным объектом</p>
<p>База данных	Базы данных являются объектами и содержат другие объекты, например, поля и индексы</p>
<p>Диаграмма	Диаграмма в Microsoft Excel является объектом</p>
<h2>Происхождение объектов</h2>
<p>Каждый объект в VBA определен классом (class). Класс используется для создания объектов и определяет их характеристики. Приведем два примера взаимоотношений между классами и объектами в VBA:</p>
 <p>Элементы управления Панели элементов управления в VBA представляют классы. Объект, известный как элемент управления, не существует, пока он не нарисован на форме. Когда создается элемент управления, создается копия, или экземпляр (instance) класса элемента управления</p>
 <p>Форма, используемая во время разработки, является классом. Во время выполнения VBA создает экземпляр класса формы</p>
<p>Окно Properties (Свойства) отображает класс и свойство Name (Имя) объектов в разработанном приложении VBA.</p>
<p>Все объекты создаются как идентичные копии своих классов. Свойства индивидуальных объектов можно изменять. Например, если на форме созданы три кнопки управления, каждый объект кнопка управления является экземпляром класса ConroandButton. Объекты одного класса используют общий набор характеристик и способностей (свойств, методов и событий). Каждому объекту дано свое имя, их можно по отдельности заблокировать и разблокировать, поместить в разные места на форме и т. д.</p>
<p>Понятие "класс объекта" не часто упоминается. Просто надо помнить, что, например, термин "элемент управления списком" означает "экземпляр класса ListBox".</p>
<h2>Что можно делать с объектами?</h2>
<p>Объект предоставляет в распоряжение разработчика готовый исполняемый код. Например, вместо того чтобы программировать собственные диалоги File Open (Открыть файл) и File Save (Сохранить файл), можно использовать элемент управления общим диалогом (объект, предоставляемый VBA). Можно написать собственный код управления планированием и ресурсами, но вместо этого проще использовать объекты Calendar (Календарь), Resources (Ресурсы) и Task (Задача), предоставляемые Microsoft Project (Проект).</p>
<p>VBA может комбинировать объекты из других источников</p>
<p>VBA предоставляет инструменты, которые позволяют комбинировать объекты из различных источников. Можно строить решения, комбинируя самые мощные возможности VBA и приложений, поддерживающих Automation (Автоматизация) (ранее известная как OLE Automation). Автоматизация (automation) - это свойство составной модели объекта (Component Object Model, СОМ), промышленного стандарта, используемого приложениями для раскрытия своих объектов инструментам разработки и другим приложениям.</p>
<p>Можно строить приложения, объединяя внутренние элементы управления VBA и объекты, предоставляемые другими приложениями. Предположим, что эти объекты помещены на форму VBA:</p>
 <p>Объект Microsoft Excel chart (Диаграмма Microsoft Excel)</p>
 <p>Объект Microsoft Excel Worksheet (Рабочий лист Microsoft Excel)</p>
 <p>Объект Microsoft Word Document (Документ Microsoft Word)</p>
<p>Эти объекты можно использовать для создания приложения. Это сохранит время разработчика, так как не надо писать код, воспроизводящий все функциональные возможности объектов Microsoft Excel и Microsoft Word.</p>
<h2>Основы работы с объектами</h2>
<p>Объекты VBA поддерживают свойства, методы и события. В VBA данные объекта (установки или атрибуты) называются свойствами, тогда как процедуры, которые оперируют с объектом, называются его методами. Событие - это действие, распознаваемое объектом, например, щелчок кнопкой мыши или нажатие клавиши клавиатуры, и программист может написать код, реагирующий на это событие.</p>
<p>Можно изменять характеристики объекта, меняя его свойства. Рассмотрим радио: одно из свойств радио - громкость (volume). В терминах обсуждаемой темы можно сказать, что радио обладает свойством "Volume", которое регулируется изменением его значения. Предположим, что можно установить регулятор громкости радио в положения от 0 до 10. Если бы радио управлялось с помощью VBA, можно было бы написать код процедуры, которая изменяла бы значение свойства "Volume" от 3 до 5, чтобы радио работало громче:</p>
<p>Radio.Volume = 5</p>
<p>Кроме свойств объекты обладают методами. Методы - это такая же часть объектов, как и свойства. В целом, методы - это действия, которые можно выполнить, тогда как свойства - это атрибуты, которые устанавливаются или восстанавливаются. Например, чтобы позвонить по телефону, надо набрать номер (dial). Можно было бы сказать, что телефоны обладают методом "Dial", и использовать этот синтаксис для набора номера 555111:</p>
<p>Phone.Dial 5551111</p>
<p>Объекты также обладают событиями. События инициируются, когда изменяются некоторые свойства объекта. Например, радио может иметь событие "VolumeChange" (Изменение громкости). Телефон может иметь событие "Ring"(Звонок).</p>
<h2>Управление объектами с помощью свойств</h2>
<p>Индивидуальные свойства меняются. Некоторые можно установить во время разработки. Для этого лучше использовать окно Properties (Свойств), что позволяет вообще не писать никакого кода. Другие свойства не доступны во время разработки, следовательно, необходимо программировать установку таких свойств во время выполнения.</p>
<p>Свойства, которые можно установить или значения которых можно получить только во время выполнения, называются изменяемыми (read-write properties). Свойства, значения которых можно только прочитать во время выполнения, называются неизменяемыми (read-only properties).</p>
</body>
</html>